[{"name":"app.R","content":"library(shiny)\n\nui <- fluidPage(\n  \n  # Application title\n  titlePanel(\"Old Faithful Geyser Data\"),\n  \n  # Sidebar with a slider input for number of bins \n  sidebarLayout(\n    sidebarPanel(\n      numericInput(\"n\",\n                  \"Sample Size:\",\n                  min = 1,\n                  max = 50,\n                  value = 30),\n      numericInput(\"d\",\n                  \"Degree:\",\n                  min = 2,\n                  max = 10,\n                  value = 2),\n      numericInput(\"i\",\n                  \"ID:\",\n                  min = 1,\n                  max = 100,\n                  value = 1)\n    ),\n    \n    # Show a plot of the generated distribution\n    mainPanel(\n      plotOutput(\"distPlot\")\n    )\n  )\n)\n\n# Define server logic required to draw a histogram\nserver <- function(input, output) {\n  \n  output$distPlot <- renderPlot({\n    # generate bins based on input$bins from ui.R\n    set.seed(input$i)\n    data = tibble::tibble(\n      X = sample(seq(0,1,0.1),input$n, replace = TRUE),\n      Y = runif(input$n,-1,1) + X^2,\n      True = X^2\n      )\n\n    # draw the histogram with the specified number of bins\n    data |> \n      dplyr::mutate(\n        Pred = lm(\n          Y ~ poly(X,input$d), \n          data = dplyr::pick(dplyr::everything())) |> \n          predict(dplyr::pick(dplyr::everything()))\n      ) |> \n      ggplot2::ggplot(\n        ggplot2::aes(\n          x = X,\n          y = Y\n        )\n      ) +\n      ggplot2::theme_bw() +\n      ggplot2::geom_point() +\n      ggplot2::geom_smooth(\n        ggplot2::aes(\n          y = Pred,\n          color = \"y ~ poly(x,d)\"\n        ),\n        se = FALSE\n      ) +\n      ggplot2::geom_smooth(\n        method = \"lm\",\n        se = FALSE,\n        ggplot2::aes(\n          color = \"y ~ x\"\n        )\n      ) +\n      ggplot2::xlim(0,1) +\n      ggplot2::ylim(-1,2) +\n      ggplot2::geom_smooth(\n        ggplot2::aes(\n          y = True,\n          color = \"Population\"\n        ),\n        method = \"lm\",\n        formula = y ~ poly(x,2),\n        se = FALSE\n      )\n  })\n}\n\n# Run the application \nshinyApp(ui = ui, server = server)\n","type":"text"}]
